Process Reporter
===

A server app deployed with a node.js server that returns the running status of a solution.

### Process Reporter API

The app currently supports the following urls:

    {urlToProcessReporterServer}/processes            // GET ONLY
    {urlToProcessReporterServer}/processes/{solution} // GET ONLY

The first form cycles through the solutions registry, and for each entry, determines if the associated processes are running.  The second form reports only the solution requested, for example:

    {urlToProcessReporterServer}/processes/org.gnome.desktop.a11y.magnifier

In both cases, the Process Reporter uses the information stored in the `isRunning` block of a solutions registry entry.  For example, the `isRunning` block for the Orca screen reader (the solution entry `org.gnome.orca`) is as
follows:
```
"isRunning": [
    {
        "type": "gpii.processReporter.find",
        "command": "orca"
    }
]
```

The payload returned is an array of solutions and their run state, followed by the platform:
```
{
    "solutions": [
        {
            "id": "org.gnome.desktop.a11y.applications",
            "running": true
        },
        {
            "id": "org.gnome.orca",
            "running": false
        },
        ...
    ],
    "OS":
    {
        "id": "linux",
        "version": "4.5.7-300.fc24.x86-64"
}}
```

If the status of only one solution is requested, then the payload is limited to that solution:

```
{
    "solutions":
    {
        "id": "org.gnome.orca",
        "running":false
    },
    "OS":
    {
        "id": "linux",
        "version": "4.5.7-300.fc24.x86-64"
    }
}
```

### Special cases

If the solutions registry entry does not have an `isRunning` block, then the solution is skipped and nothing is reported about its run-state.  NOTE: This may be incorrect, and is currently under review.

Most solutions run-state is based on a corresponding entry in the underlying OS's process or tasklist table.  For example, the Linux/GNOME solution `org.gnome.orca` is running if the `orca` screen reader process is running.  Similarly, on Windows, `org.nvda-project` is running if there is an `nvda` process in the tasklist.  Some solutions, however, are not strictly process-oriented.  An example is the GNOME Shell screen magnifier (solution `org.gnome.desktop.a11y.magnifier`).  The magnifier is not a separate process, but is built into GNOME Shell.  The magnifier is running if (1) the `gnome-shell` process is running and (2) the `org.gnome.desktop.a11y.applications screen-magnifier-enabled` GSetting is `true`.

To handle such cases, the `isRunning` block contains an array of criteria to check.  The logic is that if all criteria are met, then the solution is running.  The Process Reporter loops through and evaluates all the criteria.  Continuing to use the GNOME Shell magnifier as the example: the Linux/GNOME implementation provides for checking both the status of the gnome-shell process and the magnfier GSetting:

```
"isRunning": [
    {
        "type": "gpii.processReporter.find",
        "command": "gnome-shell"
    },
    {
        "type": "gpii.processReporter.checkSetting",
        "schema": "org.gnome.desktop.a11y.applications",
        "setting": "screen-magnifier-enabled",
        "value": true
    }
]
```

### Dependencies

[infusion](https://github.com/fluid-project/infusion) framework.
